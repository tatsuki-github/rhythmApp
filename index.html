<!DOCTYPE html>
<html lang="ja">

  <head>
    <meta charset="UTF-8" name="viewport" content="width=device-width, initial-scale=1.0" />
    
    <title>リズムトレーニング</title>

<script>
      document.write(
        '<link rel="stylesheet" href="css/style.css?' + new Date().getTime() + '">'
      );
      document.write(
        '<script src="js/script.js?' + new Date().getTime() + '"><\/script>'
      );
</script>

<!--jQuery-->
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>

<script src="js/abcjs-basic-min.js"></script>

</head>

<body>

<div class="tempo_and_piano">
  <select name="tempo_category" id="tempo_category">
    <option value="select" selected>テンポ</option>
    <option value="tempo_60">&#9833; = 60</option>
    <option value="tempo_80">&#9833; = 80</option>
    <option value="tempo_100">&#9833; = 100</option>
    <option value="tempo_120">&#9833; = 120</option>
    <option value="tempo_140">&#9833; = 140</option>
    <option value="tempo_160">&#9833; = 160</option>
  </select>
  

  <div class="buttons">
    <select name="play_mode" id="play_mode">
      <option value="select" selected>再生モード</option>
      <option value="only_code">コードのみ</option>
      <option value="only_melody">旋律のみ</option>
      <option value="play_first_half">前半再生</option>
      <option value="play_latter_half">後半再生</option>
      <option value="play">全曲再生</option>
    </select>
    
    <button id = "play"></button>
    <button id = "stop"></button>
  </div>
</div>

<div id="first">
  <div id="note"></div>

  <div class="item">
    <div class="name">
      <p>リズム</p>
      <p>音</p>
    </div>
    <div class="part">
      <div class="beat">
        <p>1</p>
        <select name="rhythm_category" id="rhythm_category1" class="rhythm">
          <option value="tan">①</option>
          <option value="tata">②</option>
          <option value="un">③</option>
          <option value="tau">④</option>
          <option value="uta">⑤</option>
          <option value="ta__n">⑥</option>
          <option value="ta_nta">⑦</option>
          <option value="tata_n">⑧</option>
        </select>
        <select name="note_category" id="note_category1" class="sound">
          <option value="E5">ミ↑</option>
          <option value="C5">ド↑</option>
          <option value="G4">ソ</option>
          <option value="E4">ミ</option>
          <option value="C4">ド</option>
  
        </select>
    </div>
    
    <div class="beat">
      <p>2</p>
      <select name="rhythm_category" id="rhythm_category2" class="rhythm">
        <option value="tan">①</option>
        <option value="tata">②</option>
        <option value="un">③</option>
        <option value="tau">④</option>
        <option value="uta">⑤</option>
      </select>
      <select name="note_category" id="note_category2" class="sound">
        <option value="E5">ミ↑</option>
        <option value="C5">ド↑</option>
        <option value="G4">ソ</option>
        <option value="E4">ミ</option>
        <option value="C4">ド</option>
      </select>
    </div>
  
    <div class="beat">
      <p>3</p>
      <select name="rhythm_category" id="rhythm_category3" class="rhythm">
        <option value="tan">①</option>
        <option value="tata">②</option>
        <option value="un">③</option>
        <option value="tau">④</option>
        <option value="uta">⑤</option>
        <option value="ta__n">⑥</option>
        <option value="ta_nta">⑦</option>
        <option value="tata_n">⑧</option>
      </select>
      <select name="note_category" id="note_category3" class="sound">
        <option value="E5">ミ↑</option>
        <option value="C5">ド↑</option>
        <option value="G4">ソ</option>
        <option value="E4">ミ</option>
        <option value="C4">ド</option>
      </select>
    </div>
  
    <div class="beat">
      <p>4</p>
      <select name="rhythm_category" id="rhythm_category4" class="rhythm">
        <option value="tan">①</option>
        <option value="tata">②</option>
        <option value="un">③</option>
        <option value="tau">④</option>
        <option value="uta">⑤</option>
      </select>
      <select name="note_category" id="note_category4" class="sound">
        <option value="E5">ミ↑</option>
        <option value="C5">ド↑</option>
        <option value="G4">ソ</option>
        <option value="E4">ミ</option>
        <option value="C4">ド</option>
      </select>
    </div>
    </div>
    
  
    <div class="part">
      <div class="beat">
        <p>5</p>
        <select name="rhythm_category" id="rhythm_category5" class="rhythm">
          <option value="tan">①</option>
          <option value="tata">②</option>
          <option value="un">③</option>
          <option value="tau">④</option>
          <option value="uta">⑤</option>
          <option value="ta__n">⑥</option>
          <option value="ta_nta">⑦</option>
          <option value="tata_n">⑧</option>
        </select>
        <select name="note_category" id="note_category5" class="sound">
          <option value="E5">ミ↑</option>
          <option value="C5">ド↑</option>
          <option value="A4">ラ</option>
          <option value="E4">ミ</option>
          <option value="C4">ド</option>
        </select>
      </div>
  
      <div class="beat">
        <p>6</p>
        <select name="rhythm_category" id="rhythm_category6" class="rhythm">
          <option value="tan">①</option>
          <option value="tata">②</option>
          <option value="un">③</option>
          <option value="tau">④</option>
          <option value="uta">⑤</option>
        </select>
        <select name="note_category" id="note_category6" class="sound">
          <option value="E5">ミ↑</option>
          <option value="C5">ド↑</option>
          <option value="A4">ラ</option>
          <option value="E4">ミ</option>
          <option value="C4">ド</option>
        </select>
      </div>
  
      <div class="beat">
        <p>7</p>
        <select name="rhythm_category" id="rhythm_category7" class="rhythm">
          <option value="tan">①</option>
          <option value="tata">②</option>
          <option value="un">③</option>
          <option value="tau">④</option>
          <option value="uta">⑤</option>
          <option value="ta__n">⑥</option>
          <option value="ta_nta">⑦</option>
          <option value="tata_n">⑧</option>
        </select>
        <select name="note_category" id="note_category7" class="sound">
          <option value="E5">ミ↑</option>
          <option value="C5">ド↑</option>
          <option value="A4">ラ</option>
          <option value="E4">ミ</option>
          <option value="C4">ド</option>
        </select>
      </div>
  
      <div class="beat">
        <p>8</p>
        <select name="rhythm_category" id="rhythm_category8" class="rhythm">
          <option value="tan">①</option>
          <option value="tata">②</option>
          <option value="un">③</option>
          <option value="tau">④</option>
          <option value="uta">⑤</option>
        </select>
        <select name="note_category" id="note_category8" class="sound">
          <option value="E5">ミ↑</option>
          <option value="C5">ド↑</option>
          <option value="A4">ラ</option>
          <option value="E4">ミ</option>
          <option value="C4">ド</option>
        </select>
      </div>
    </div>
    
  
    <div class="part">
      <div class="beat">
        <p>9</p>
        <select name="rhythm_category" id="rhythm_category9" class="rhythm">
          <option value="tan">①</option>
          <option value="tata">②</option>
          <option value="un">③</option>
          <option value="tau">④</option>
          <option value="uta">⑤</option>
          <option value="ta__n">⑥</option>
          <option value="ta_nta">⑦</option>
          <option value="tata_n">⑧</option>
        </select>
        <select name="note_category" id="note_category9" class="sound">
          <option value="C5">ド↑</option>
          <option value="A4">ラ</option>
          <option value="F4">ファ</option>
          <option value="C4">ド</option>
        </select>
      </div>
  
      <div class="beat">
        <p>10</p>
        <select name="rhythm_category" id="rhythm_category10" class="rhythm">
          <option value="tan">①</option>
          <option value="tata">②</option>
          <option value="un">③</option>
          <option value="tau">④</option>
          <option value="uta">⑤</option>
        </select>
        <select name="note_category" id="note_category10" class="sound">
          <option value="C5">ド↑</option>
          <option value="A4">ラ</option>
          <option value="F4">ファ</option>
          <option value="C4">ド</option>
        </select>
      </div>
  
      <div class="beat">
        <p>11</p>
        <select name="rhythm_category" id="rhythm_category11" class="rhythm">
          <option value="tan">①</option>
          <option value="tata">②</option>
          <option value="un">③</option>
          <option value="tau">④</option>
          <option value="uta">⑤</option>
          <option value="ta__n">⑥</option>
          <option value="ta_nta">⑦</option>
          <option value="tata_n">⑧</option>
        </select>
        <select name="note_category" id="note_category11" class="sound">
          <option value="C5">ド↑</option>
          <option value="A4">ラ</option>
          <option value="F4">ファ</option>
          <option value="C4">ド</option>
        </select>
      </div>
  
      <div class="beat">
        <p>12</p>
        <select name="rhythm_category" id="rhythm_category12" class="rhythm">
          <option value="tan">①</option>
          <option value="tata">②</option>
          <option value="un">③</option>
          <option value="tau">④</option>
          <option value="uta">⑤</option>
        </select>
        <select name="note_category" id="note_category12" class="sound">
          <option value="C5">ド↑</option>
          <option value="A4">ラ</option>
          <option value="F4">ファ</option>
          <option value="C4">ド</option>
        </select>
      </div>
    </div>
    
  
    <div class="part">
      <div class="beat">
        <p>13</p>
        <select name="rhythm_category" id="rhythm_category13" class="rhythm">
          <option value="tan">①</option>
          <option value="tata">②</option>
          <option value="un">③</option>
          <option value="tau">④</option>
          <option value="uta">⑤</option>
          <option value="ta__n">⑥</option>
          <option value="ta_nta">⑦</option>
          <option value="tata_n">⑧</option>
        </select>
        <select name="note_category" id="note_category13" class="sound">
          <option value="D5">レ↑</option>
          <option value="B4">シ</option>
          <option value="G4">ソ</option>
          <option value="D4">レ</option>
        </select>
      </div>
  
      <div class="beat">
        <p>14</p>
        <select name="rhythm_category" id="rhythm_category14" class="rhythm">
          <option value="tan">①</option>
          <option value="tata">②</option>
          <option value="un">③</option>
          <option value="tau">④</option>
          <option value="uta">⑤</option>
        </select>
        <select name="note_category" id="note_category14" class="sound">
          <option value="D5">レ↑</option>
          <option value="B4">シ</option>
          <option value="G4">ソ</option>
          <option value="D4">レ</option>
        </select>
      </div>
  
      <div class="beat">
        <p>15</p>
        <select name="rhythm_category" id="rhythm_category15" class="rhythm">
          <option value="tan">①</option>
          <option value="tata">②</option>
          <option value="un">③</option>
          <option value="tau">④</option>
          <option value="uta">⑤</option>
          <option value="ta__n">⑥</option>
          <option value="ta_nta">⑦</option>
          <option value="tata_n">⑧</option>
        </select>
        <select name="note_category" id="note_category15" class="sound">
          <option value="D5">レ↑</option>
          <option value="B4">シ</option>
          <option value="G4">ソ</option>
          <option value="D4">レ</option>
        </select>
      </div>
  
      <div class="beat">
        <p>16</p>
        <select name="rhythm_category" id="rhythm_category16" class="rhythm">
          <option value="tan">①</option>
          <option value="tata">②</option>
          <option value="un">③</option>
          <option value="tau">④</option>
          <option value="uta">⑤</option>
        </select>
        <select name="note_category" id="note_category16" class="sound">
          <option value="D5">レ↑</option>
          <option value="B4">シ</option>
          <option value="G4">ソ</option>
          <option value="D4">レ</option>
        </select>
      </div>
    </div>
  </div>
</div>

<div id="latter">
  <div id="note2"></div>

  <div class="item">
    <div class="part">
      <div class="beat">
        <p>17</p>
          <select name="rhythm_category" id="rhythm_category17" class="rhythm">
            <option value="tan">①</option>
            <option value="tata">②</option>
            <option value="un">③</option>
            <option value="tau">④</option>
            <option value="uta">⑤</option>
            <option value="ta__n">⑥</option>
            <option value="ta_nta">⑦</option>
            <option value="tata_n">⑧</option>
          </select>
          <select name="note_category" id="note_category17" class="sound">
            <option value="E5">ミ↑</option>
            <option value="C5">ド↑</option>
            <option value="G4">ソ</option>
            <option value="E4">ミ</option>
            <option value="C4">ド</option>
          </select>
      </div>
  
      <div class="beat">
        <p>18</p>
        <select name="rhythm_category" id="rhythm_category18" class="rhythm">
          <option value="tan">①</option>
          <option value="tata">②</option>
          <option value="un">③</option>
          <option value="tau">④</option>
          <option value="uta">⑤</option>
        </select>
        <select name="note_category" id="note_category18" class="sound">
          <option value="E5">ミ↑</option>
          <option value="C5">ド↑</option>
          <option value="G4">ソ</option>
          <option value="E4">ミ</option>
          <option value="C4">ド</option>
        </select>
      </div>
  
      <div class="beat">
        <p>19</p>
        <select name="rhythm_category" id="rhythm_category19" class="rhythm">
          <option value="tan">①</option>
          <option value="tata">②</option>
          <option value="un">③</option>
          <option value="tau">④</option>
          <option value="uta">⑤</option>
          <option value="ta__n">⑥</option>
          <option value="ta_nta">⑦</option>
          <option value="tata_n">⑧</option>
        </select>
        <select name="note_category" id="note_category19" class="sound">
          <option value="E5">ミ↑</option>
          <option value="C5">ド↑</option>
          <option value="G4">ソ</option>
          <option value="E4">ミ</option>
          <option value="C4">ド</option>
        </select>
      
      </div>
  
      <div class="beat">
        <p>20</p>
        <select name="rhythm_category" id="rhythm_category20" class="rhythm">
          <option value="tan">①</option>
          <option value="tata">②</option>
          <option value="un">③</option>
          <option value="tau">④</option>
          <option value="uta">⑤</option>
        </select>
        <select name="note_category" id="note_category20" class="sound">
          <option value="E5">ミ↑</option>
          <option value="C5">ド↑</option>
          <option value="G4">ソ</option>
          <option value="E4">ミ</option>
          <option value="C4">ド</option>
        </select>
      </div>
    </div>  
    
  
    <div class="part">
      <div class="beat">
        <p>21</p>
        <select name="rhythm_category" id="rhythm_category21" class="rhythm">
          <option value="tan">①</option>
          <option value="tata">②</option>
          <option value="un">③</option>
          <option value="tau">④</option>
          <option value="uta">⑤</option>
          <option value="ta__n">⑥</option>
          <option value="ta_nta">⑦</option>
          <option value="tata_n">⑧</option>
        </select>
        <select name="note_category" id="note_category21" class="sound">
          <option value="E5">ミ↑</option>
          <option value="C5">ド↑</option>
          <option value="A4">ラ</option>
          <option value="E4">ミ</option>
          <option value="C4">ド</option>
        </select>
      </div>
  
      <div class="beat">
        <p>22</p>
        <select name="rhythm_category" id="rhythm_category22" class="rhythm">
          <option value="tan">①</option>
          <option value="tata">②</option>
          <option value="un">③</option>
          <option value="tau">④</option>
          <option value="uta">⑤</option>
        </select>
        <select name="note_category" id="note_category22" class="sound">
          <option value="E5">ミ↑</option>
          <option value="C5">ド↑</option>
          <option value="A4">ラ</option>
          <option value="E4">ミ</option>
          <option value="C4">ド</option>
        </select>
      
      </div>
      <div class="beat">
        <p>23</p>
        <select name="rhythm_category" id="rhythm_category23" class="rhythm">
          <option value="tan">①</option>
          <option value="tata">②</option>
          <option value="un">③</option>
          <option value="tau">④</option>
          <option value="uta">⑤</option>
          <option value="ta__n">⑥</option>
          <option value="ta_nta">⑦</option>
          <option value="tata_n">⑧</option>
        </select>
        <select name="note_category" id="note_category23" class="sound">
          <option value="E5">ミ↑</option>
          <option value="C5">ド↑</option>
          <option value="A4">ラ</option>
          <option value="E4">ミ</option>
          <option value="C4">ド</option>
        </select>
      </div>
  
      <div class="beat">
        <p>24</p>
        <select name="rhythm_category" id="rhythm_category24" class="rhythm">
          <option value="tan">①</option>
          <option value="tata">②</option>
          <option value="un">③</option>
          <option value="tau">④</option>
          <option value="uta">⑤</option>
        </select>
        <select name="note_category" id="note_category24" class="sound">
          <option value="E5">ミ↑</option>
          <option value="C5">ド↑</option>
          <option value="A4">ラ</option>
          <option value="E4">ミ</option>
          <option value="C4">ド</option>
        </select>
      </div>
    </div>
    
  
    <div class="part">
      <div class="beat">
        <p>25</p>
        <select name="rhythm_category" id="rhythm_category25" class="rhythm">
          <option value="tan">①</option>
          <option value="tata">②</option>
          <option value="un">③</option>
          <option value="tau">④</option>
          <option value="uta">⑤</option>
          <option value="ta__n">⑥</option>
          <option value="ta_nta">⑦</option>
          <option value="tata_n">⑧</option>
        </select>
        <select name="note_category" id="note_category25" class="sound">
          <option value="D5">レ↑</option>
          <option value="A4">ラ</option>
          <option value="F4">ファ</option>
          <option value="D4">レ</option>
        </select>
      </div>
  
      <div class="beat">
        <p>26</p>
        <select name="rhythm_category" id="rhythm_category26" class="rhythm">
          <option value="tan">①</option>
          <option value="tata">②</option>
          <option value="un">③</option>
          <option value="tau">④</option>
          <option value="uta">⑤</option>
        </select>
        <select name="note_category" id="note_category26" class="sound">
          <option value="D5">レ↑</option>
          <option value="A4">ラ</option>
          <option value="F4">ファ</option>
          <option value="D4">レ</option>
        </select>
      </div>
  
      <div class="beat">
        <p>27</p>
        <select name="rhythm_category" id="rhythm_category27" class="rhythm">
          <option value="tan">①</option>
          <option value="tata">②</option>
          <option value="un">③</option>
          <option value="tau">④</option>
          <option value="uta">⑤</option>
          <option value="ta__n">⑥</option>
          <option value="ta_nta">⑦</option>
          <option value="tata_n">⑧</option>
        </select>
        <select name="note_category" id="note_category27" class="sound">
          <option value="D5">レ↑</option>
          <option value="A4">ラ</option>
          <option value="F4">ファ</option>
          <option value="D4">レ</option>
        </select>
      </div>
  
      <div class="beat">
        <p>28</p>
        <select name="rhythm_category" id="rhythm_category28" class="rhythm">
          <option value="tan">①</option>
          <option value="tata">②</option>
          <option value="un">③</option>
          <option value="tau">④</option>
          <option value="uta">⑤</option>
        </select>
        <select name="note_category" id="note_category28" class="sound">
          <option value="D5">レ↑</option>
          <option value="A4">ラ</option>
          <option value="F4">ファ</option>
          <option value="D4">レ</option>
        </select>
      </div>
    </div>
    
  
    <div class="part">
      <div class="beat">
        <p>29</p>
        <select name="rhythm_category" id="rhythm_category29" class="rhythm">
          <option value="tan">①</option>
          <option value="tata">②</option>
          <option value="un">③</option>
          <option value="tau">④</option>
          <option value="uta">⑤</option>
          <option value="ta__n">⑥</option>
          <option value="ta_nta">⑦</option>
          <option value="tata_n">⑧</option>
        </select>
        <select name="note_category" id="note_category29" class="sound">
          <option value="E5">ミ↑</option>
          <option value="C5">ド↑</option>
          <option value="G4">ソ</option>
          <option value="E4">ミ</option>
          <option value="C4">ド</option>
        </select>
      </div>
  
      <div class="beat">
        <p>30</p>
        <select name="rhythm_category" id="rhythm_category30" class="rhythm">
          <option value="tan">①</option>
          <option value="tata">②</option>
          <option value="un">③</option>
          <option value="tau">④</option>
          <option value="uta">⑤</option>
        </select>
        <select name="note_category" id="note_category30" class="sound">
          <option value="E5">ミ↑</option>
          <option value="C5">ド↑</option>
          <option value="G4">ソ</option>
          <option value="E4">ミ</option>
          <option value="C4">ド</option>
        </select>
      </div>
  
      <div class="beat">
        <p>31</p>
        <select name="rhythm_category" id="rhythm_category31" class="rhythm">
          <option value="tan">①</option>
          <option value="tata">②</option>
          <option value="un">③</option>
          <option value="tau">④</option>
          <option value="uta">⑤</option>
          <option value="ta__n">⑥</option>
          <option value="ta_nta">⑦</option>
          <option value="tata_n">⑧</option>
        </select>
        <select name="note_category" id="note_category31" class="sound">
          <option value="E5">ミ↑</option>
          <option value="C5">ド↑</option>
          <option value="G4">ソ</option>
          <option value="E4">ミ</option>
          <option value="C4">ド</option>
        </select>
      </div>
  
      <div class="beat">
        <p>32</p>
        <select name="rhythm_category" id="rhythm_category32" class="rhythm">
          <option value="tan">①</option>
          <option value="tata">②</option>
          <option value="un">③</option>
          <option value="tau">④</option>
          <option value="uta">⑤</option>
        </select>
        <select name="note_category" id="note_category32" class="sound">
          <option value="E5">ミ↑</option>
          <option value="C5">ド↑</option>
          <option value="G4">ソ</option>
          <option value="E4">ミ</option>
          <option value="C4">ド</option>
        </select>
      </div>
    </div>
  </div>
</div>


    


<script>
  window.addEventListener("load", function(){
    displayNote();
  }, false)

function btnDisable(){ 
document.getElementById("play").disabled = true;
document.getElementById("play").style.backgroundColor = "#C0C0C0"
clearInterval(statusDis);
}
function btnAble(){  
document.getElementById("play").disabled = false;
document.getElementById("play").style.backgroundColor = "#ff7e00"
clearInterval(statusAble);
}

function clicked(){ 
statusDis  = setInterval(btnDisable , 0); 
if(play_mode.value == "play_first_half" || play_mode.value == "play_latter_half"){
  switch (tempo_category.value){
    case "tempo_60":
    statusAble = setInterval(btnAble , 17000); 
        break;
    case "tempo_80":
    statusAble = setInterval(btnAble , 13000); 
        break;
    case "tempo_100":
    statusAble = setInterval(btnAble , 10500); 
        break;
    case "tempo_120":
    statusAble = setInterval(btnAble , 9000); 
        break;    
    case "tempo_140":
    statusAble = setInterval(btnAble , 8000); 
        break;    
    case "tempo_160":
    statusAble = setInterval(btnAble , 7000); 
        break;    
    default:  
  }  
}
else{
  switch (tempo_category.value){
    case "tempo_60":
    statusAble = setInterval(btnAble , 33000); 
        break;
    case "tempo_80":
    statusAble = setInterval(btnAble , 25000); 
        break;
    case "tempo_100":
    statusAble = setInterval(btnAble , 17000); 
        break;
    case "tempo_120":
    statusAble = setInterval(btnAble , 16500); 
        break;    
    case "tempo_140":
    statusAble = setInterval(btnAble , 14500); 
        break;    
    case "tempo_160":
    statusAble = setInterval(btnAble , 12500); 
        break;           
    default:  
  }  
}
}

document.getElementById("play").addEventListener("click", function() {
    playMode();
    clicked();
}, false);

document.getElementById("stop").addEventListener("click", function() {
    Refresh();
}, false);






    const note_category = [note_category1,note_category2,note_category3,note_category4,note_category5,note_category6,note_category7,note_category8,note_category9,note_category10,note_category11,note_category12,note_category13,note_category14,note_category15,note_category16,note_category17,note_category18,note_category19,note_category20,note_category21,note_category22,note_category23,note_category24,note_category25,note_category26,note_category27,note_category28,note_category29,note_category30,note_category31,note_category32];
    const rhythm_category = [rhythm_category1,rhythm_category2,rhythm_category3,rhythm_category4,rhythm_category5,rhythm_category6,rhythm_category7,rhythm_category8,rhythm_category9,rhythm_category10,rhythm_category11,rhythm_category12,rhythm_category13,rhythm_category14,rhythm_category15,rhythm_category16,rhythm_category17,rhythm_category18,rhythm_category19,rhythm_category20,rhythm_category21,rhythm_category22,rhythm_category23,rhythm_category24,rhythm_category25,rhythm_category26,rhythm_category27,rhythm_category28,rhythm_category29,rhythm_category30,rhythm_category31,rhythm_category32];
    
    for(i = 0; i < 32; i++){
      note_category[i] = document.getElementById(`note_category${i+1}`);
      rhythm_category[i] = document.getElementById(`rhythm_category${i+1}`);
    }

    for(i = 0; i < 32; i++){
      note_category[i].onchange = displayNote;
      rhythm_category[i].onchange = displayNote;
    }

    const tempo_category = document.getElementById("tempo_category");
    tempo_category.onchange = Refresh;

    const play_mode = document.getElementById("play_mode");
    play_mode.onchange = Refresh;
    const first = document.getElementById("first");
    const latter = document.getElementById("latter");
    

    play_mode.onchange = displayNote;


    
function Refresh(){
  Tone.Transport.stop();
  Tone.Transport.cancel();
  btnAble();
}

   
function preparePlay(){
  if(tempo_category.value == "select"){
    tempo_category.value = "tempo_100";    
    }
  if(play_mode.value == "select"){
    play_mode.value = "play";    
    }
  
  for(i = 0; i < rhythm_category.length; i++){
    if(rhythm_category[i].value == "select"){
    rhythm_category[i].value = "tan";    
    }
  }
}

const notes = new Array(32); 

function rhythmDisplayFirst(){
  for(i = 0; i < rhythm_category.length/2; i++){
    note_category[i].style.visibility = "visible";
    rhythm_category[i].style.visibility = "visible";
  }
  for(i = 1; i < rhythm_category.length/2; i+=2){
    if(rhythm_category[i-1].value == "ta__n"){
      rhythm_category[i].style.visibility = "hidden";
      note_category[i].style.visibility = "hidden";
    }
    else if(rhythm_category[i-1].value == "ta_nta" || rhythm_category[i-1].value == "tata_n"){
      rhythm_category[i].style.visibility = "hidden";
    }
    else{
      rhythm_category[i].style.visibility = "visible";
      note_category[i].style.visibility = "visible";
    }
  }
  if(rhythm_category[0].value == "un"){
    note_category[0].style.visibility = "hidden";
  }
  else{
    note_category[0].style.visibility = "visible";
  }
  
  for(i = 1; i < rhythm_category.length/2; i++){
    if(rhythm_category[i].value == "un"){
      note_category[i].style.visibility = "hidden";
    }
    else if(rhythm_category[i-1].value == "ta__n"){
      note_category[i].style.visibility = "hidden";
    }
    else{
      note_category[i].style.visibility = "visible";
    }
  }
}
function rhythmDisplayLatter(){
  for(i = 16; i < rhythm_category.length; i++){
    note_category[i].style.visibility = "visible";
    rhythm_category[i].style.visibility = "visible";
  }
  for(i = 17; i < rhythm_category.length; i+=2){
    if(rhythm_category[i-1].value == "ta__n"){
      rhythm_category[i].style.visibility = "hidden";
      note_category[i].style.visibility = "hidden";
    }
    else if(rhythm_category[i-1].value == "ta_nta" || rhythm_category[i-1].value == "tata_n"){
      rhythm_category[i].style.visibility = "hidden";
    }
    else{
      rhythm_category[i].style.visibility = "visible";
      note_category[i].style.visibility = "visible";
    }
  }

  if(rhythm_category[16].value == "un"){
    note_category[16].style.visibility = "hidden";
  }
  else{
    note_category[16].style.visibility = "visible";
  }
  
  for(i = 17; i < rhythm_category.length; i++){
    if(rhythm_category[i].value == "un"){
      note_category[i].style.visibility = "hidden";
    }
    else if(rhythm_category[i-1].value == "ta__n"){
      note_category[i].style.visibility = "hidden";
    }
    else{
      note_category[i].style.visibility = "visible";
    }
  }
}

function rhythmDisplayFirstClear(){
  for(i = 0; i < rhythm_category.length/2; i++){
    note_category[i].style.visibility = "hidden";
    rhythm_category[i].style.visibility = "hidden";
  }
}
function rhythmDisplayLatterClear(){
  for(i = 16; i < rhythm_category.length; i++){
    note_category[i].style.visibility = "hidden";
    rhythm_category[i].style.visibility = "hidden";
  }
}
function displayNote(){

  if(play_mode.value == "play_first_half"){
    first.style.visibility = "visible";
    latter.style.visibility = "hidden";
    rhythmDisplayFirst();
    rhythmDisplayLatterClear();
  }
  else if(play_mode.value == "play_latter_half"){
    first.style.visibility = "hidden";
    latter.style.visibility = "visible";
    rhythmDisplayLatter();
    rhythmDisplayFirstClear();
  }
  else{
    first.style.visibility = "visible";
    latter.style.visibility = "visible";
    rhythmDisplayFirst();
    rhythmDisplayLatter();
  }

  changeRythm();
  ABCJS.renderAbc("note","L:1/4\n " + `${notes[0]}` + notes[1] + notes[2] + notes[3] + "|" + `${notes[4]}` + notes[5] + notes[6] + notes[7] + "|" + `${notes[8]}` + notes[9] + notes[10] + notes[11] + "|" + `${notes[12]}`  + notes[13] + notes[14] + notes[15] + "|" + `${notes[16]}` + notes[17] + notes[18] + notes[19] + "|" + `${notes[20]}` + notes[21] + notes[22] + notes[23] ,{add_classes: true,responsive: "resize",paddingtop:"0",paddingbottom:"-16"});
  ABCJS.renderAbc("note2","L:1/4\n " + `${notes[0]}` + notes[1] + notes[2] + notes[3] + "|" + `${notes[4]}` + notes[5] + notes[6] + notes[7] + "|" + `${notes[8]}` + notes[9] + notes[10] + notes[11] + "|" + `${notes[12]}`  + notes[13] + notes[14] + notes[15] + "|" + `${notes[16]}` + notes[17] + notes[18] + notes[19] + "|" + `${notes[20]}` + notes[21] + notes[22] + notes[23] ,{add_classes: true,responsive: "resize",paddingtop:"0",paddingbottom:"-16"});
  

}    


function changeRythm(){
  let display_note;
  
    for(i = 0; i < rhythm_category.length; i+=2){
      switch(note_category[i].value){
        case "C4":
          display_note = "C";
          break;
        case "D4":
          display_note = "D";
          break;
        case "E4":
          display_note = "E";
          break;
        case "F4":
          display_note = "F";
          break;
        case "G4":
          display_note = "G";
          break;
        case "A4":
          display_note = "A";
          break;
        case "B4":
          display_note = "B";
          break;
        case "C5":
          display_note = "c";
          break;
        case "D5":
          display_note = "d";
          break;
        case "E5":
          display_note = "e";
          break;
        default:
          display_note = "E";
      }
      switch(rhythm_category[i].value){
          case "tan":
          notes[i] = ` ${display_note} `;
          rhythm_category[i].style.backgroundColor = "lightblue";
          break;
          case "tata":
          notes[i] = `${display_note}/${display_note}/2 `;
          rhythm_category[i].style.backgroundColor = "lightblue";
          break;
          case "un":
          notes[i] = "z";
          rhythm_category[i].style.backgroundColor = "lightblue";
          break;
          case "tau":
          notes[i] = `${display_note}/2z/2 `;
          rhythm_category[i].style.backgroundColor = "lightblue";
          break;
          case "uta":
          notes[i] = `z/2${display_note}/2 `;
          rhythm_category[i].style.backgroundColor = "lightblue";
          break;
          case "ta__n":
          notes[i] = ` ${display_note}2 `;
          rhythm_category[i].style.backgroundColor = "lightpink";
          break;
          case "ta_nta":
          notes[i] = `${display_note}3/2`;
          rhythm_category[i].style.backgroundColor = "lightpink";
          break;
          case "tata_n":
          notes[i] = `${display_note}/2`;
          rhythm_category[i].style.backgroundColor = "lightpink";
          break;
          default:
          notes[i] = ` ${display_note} `;
      } 
  }

  for(i = 1; i < rhythm_category.length; i+=2){
      switch(note_category[i].value){
        case "C4":
          display_note = "C";
          break;
        case "D4":
          display_note = "D";
          break;
        case "E4":
          display_note = "E";
          break;
        case "F4":
          display_note = "F";
          break;
        case "G4":
          display_note = "G";
          break;
        case "A4":
          display_note = "A";
          break;
        case "B4":
          display_note = "B";
          break;
        case "C5":
          display_note = "c";
          break;
        case "D5":
          display_note = "d";
          break;
        case "E5":
          display_note = "e";
          break;
        default:
          display_note = "E";
      }
    if(rhythm_category[i-1].value == "ta__n"){
      notes[i] = "t";
    }
    else if(rhythm_category[i-1].value == "ta_nta"){
      notes[i] = `${display_note}/2 `;
    }
    else if(rhythm_category[i-1].value == "tata_n"){
      notes[i] = `${display_note}3/2 `;
    }
    else{
      switch(rhythm_category[i].value){
          case "tan":
          notes[i] = ` ${display_note} `;
          rhythm_category[i].style.backgroundColor = "lightblue";
          break;
          case "tata":
          notes[i] = `${display_note}/${display_note}/2 `;
          rhythm_category[i].style.backgroundColor = "lightblue";
          break;
          case "un":
          notes[i] = "z";
          rhythm_category[i].style.backgroundColor = "lightblue";
          break;
          case "tau":
          notes[i] = `${display_note}/2z/2 `;
          rhythm_category[i].style.backgroundColor = "lightblue";
          break;
          case "uta":
          notes[i] = `z/2${display_note}/2 `;
          rhythm_category[i].style.backgroundColor = "lightblue";
          break;
          default:
          notes[i] = ` ${display_note} `;
          } 
    }
  }
}
  
function playMode(){
  switch (play_mode.value){
    case "only_code":
        break;
    case "only_melody":
      playMelody();
        break;
    case "play_first_half":
      playMelodyFirstHalf();
        break;
    case "play_latter_half":
      playMelodyLatterHalf();
        break;    
    case "play":
      playMelody();
        break;    
    default:  
      playMelody();
  }    
}

function changeTempo(){
    switch (tempo_category.value){
    case "tempo_60":
    Tone.Transport.bpm.value = 60;
        break;
    case "tempo_80":
    Tone.Transport.bpm.value = 80;
        break;
    case "tempo_100":
    Tone.Transport.bpm.value = 100;
        break;
    case "tempo_120":
    Tone.Transport.bpm.value = 120;     
        break;    
    case "tempo_140":
    Tone.Transport.bpm.value = 140;     
        break;    
    case "tempo_160":
    Tone.Transport.bpm.value = 160;     
        break;      
    default:  
  }  
}

function playMelody() {
  const synth = new Tone.MembraneSynth().toDestination();
  /*
  AMSynth
  DuoSynth
  FMSynth
  MembraneSynth
  MetalSynth
  MonoSynth
  NoiseSynth
  PluckSynth
  PolySynth
  Sampler
  Synth
  */
  changeTempo();
  preparePlay();
  const item = {
  0:{note: note_category[0].value, duration: "4n"},
  1:{note: note_category[1].value, duration: "4n"},
  2:{note: note_category[2].value, duration: "4n"},
  3:{note: note_category[3].value, duration: "4n"},
  4:{note: note_category[4].value, duration: "4n"},
  5:{note: note_category[5].value, duration: "4n"},
  6:{note: note_category[6].value, duration: "4n"},
  7:{note: note_category[7].value, duration: "4n"},
  8:{note: note_category[8].value, duration: "4n"},
  9:{note: note_category[9].value, duration: "4n"},
  10:{note: note_category[10].value, duration: "4n"},
  11:{note: note_category[11].value, duration: "4n"},
  12:{note: note_category[12].value, duration: "4n"},
  13:{note: note_category[13].value, duration: "4n"},
  14:{note: note_category[14].value, duration: "4n"},
  15:{note: note_category[15].value, duration: "4n"},
  16:{note: note_category[16].value, duration: "4n"},
  17:{note: note_category[17].value, duration: "4n"},
  18:{note: note_category[18].value, duration: "4n"},
  19:{note: note_category[19].value, duration: "4n"},
  20:{note: note_category[20].value, duration: "4n"},
  21:{note: note_category[21].value, duration: "4n"},
  22:{note: note_category[22].value, duration: "4n"},
  23:{note: note_category[23].value, duration: "4n"},
  24:{note: note_category[24].value, duration: "4n"},
  25:{note: note_category[25].value, duration: "4n"},
  26:{note: note_category[26].value, duration: "4n"},
  27:{note: note_category[27].value, duration: "4n"},
  28:{note: note_category[28].value, duration: "4n"},
  29:{note: note_category[29].value, duration: "4n"},
  30:{note: note_category[30].value, duration: "4n"},
  31:{note: note_category[31].value, duration: "4n"},
  32:null,
  33:null,
  34:null,
  35:null,
  36:null,
  37:null,
  38:null,
  39:null,
  40:null,
  41:null,
  42:null,
  43:null,
  44:null,
  45:null,
  46:null,
  47:null,
  48:null,
  49:null,
  50:null,
  51:null,
  52:null,
  53:null,
  54:null,
  55:null,
  56:null,
  57:null,
  58:null,
  59:null,
  60:null,
  61:null,
  62:null,
  63:null,
};

for(i = 0; i < rhythm_category.length; i+=2){
    switch(rhythm_category[i].value){
    case "tata":
    item[`${i+32}`] = {note: note_category[i].value, duration: "4n"};
    break;
    case "un":
    item[`${i}`] = null;
    break;
    case "tau":
    item[`${i}`] = {note: note_category[i].value, duration: "4n"};
    item[`${i+32}`] = {note: null, duration: "4n"};
    break;
    case "uta":
    item[`${i}`] = {note: null, duration: "4n"};
    item[`${i+32}`] = {note: note_category[i].value, duration: "4n"};
    break;
    case "ta__n":
    item[`${i}`]["duration"] = "2n";
    break;
    case "ta_nta":
    item[`${i}`]["duration"] = "3n";
    break;
    case "tata_n":
    item[`${i}`]["duration"] = "8n";
    item[`${i+32}`] = {note: note_category[i+1].value, duration: "3n"};
    break;
    default:
  }
}

for(i = 1; i < rhythm_category.length; i+=2){
  if(rhythm_category[i-1].value == "ta__n"){
      item[`${i}`] = null;
    }
    else if(rhythm_category[i-1].value == "ta_nta"){
      item[`${i}`] = null;
      item[`${i+32}`] = {note: note_category[i].value, duration: "8n"};
    }
    else if(rhythm_category[i-1].value == "tata_n"){
      item[`${i}`] = null;
    }
  else{
    switch(rhythm_category[i].value){
    case "tata":
    item[`${i+32}`] = {note: note_category[i].value, duration: "4n"};
    break;
    case "un":
    item[`${i}`] = null;
    break;
    case "tau":
    item[`${i}`] = {note: note_category[i].value, duration: "4n"};
    item[`${i+32}`] = {note: null, duration: "4n"};
    break;
    case "uta":
    item[`${i}`] = {note: null, duration: "4n"};
    item[`${i+32}`] = {note: note_category[i].value, duration: "4n"};
    break;
    default:
    }
  }
}
const melodyList = [
  item["0"],item["32"],item["1"],item["33"],item["2"],item["34"],item["3"],item["35"],
  item["4"],item["36"],item["5"],item["37"],item["6"],item["38"],item["7"],item["39"],
  item["8"],item["40"],item["9"],item["41"],item["10"],item["42"],item["11"],item["43"],
  item["12"],item["44"],item["13"],item["45"],item["14"],item["46"],item["15"],item["47"],
  item["16"],item["48"],item["17"],item["49"],item["18"],item["50"],item["19"],item["51"],
  item["20"],item["52"],item["21"],item["53"],item["22"],item["54"],item["23"],item["55"],
  item["24"],item["56"],item["25"],item["57"],item["26"],item["58"],item["27"],item["59"],
  item["28"],item["60"],item["29"],item["61"],item["30"],item["62"],item["31"],item["63"]
];

function setPlay(time, note) {synth.triggerAttackRelease(note.note, note.duration, time);}
    const melody = new Tone.Sequence(setPlay, melodyList).start();
    melody.loop = 0;  
    Tone.Transport.start();
}

function playMelodyFirstHalf(){
  const synth = new Tone.Synth().toDestination();
  changeTempo();
  preparePlay();
  const item = {
  0:{note: note_category[0].value, duration: "4n"},
  1:{note: note_category[1].value, duration: "4n"},
  2:{note: note_category[2].value, duration: "4n"},
  3:{note: note_category[3].value, duration: "4n"},
  4:{note: note_category[4].value, duration: "4n"},
  5:{note: note_category[5].value, duration: "4n"},
  6:{note: note_category[6].value, duration: "4n"},
  7:{note: note_category[7].value, duration: "4n"},
  8:{note: note_category[8].value, duration: "4n"},
  9:{note: note_category[9].value, duration: "4n"},
  10:{note: note_category[10].value, duration: "4n"},
  11:{note: note_category[11].value, duration: "4n"},
  12:{note: note_category[12].value, duration: "4n"},
  13:{note: note_category[13].value, duration: "4n"},
  14:{note: note_category[14].value, duration: "4n"},
  15:{note: note_category[15].value, duration: "4n"},
  15:{note: note_category[15].value, duration: "4n"},
  16:null,
  17:null,
  18:null,
  19:null,
  20:null,
  21:null,
  22:null,
  23:null,
  24:null,
  25:null,
  26:null,
  27:null,
  28:null,
  29:null,
  30:null,
  31:null
};

for(i = 0; i < rhythm_category.length; i+=2){
    switch(rhythm_category[i].value){
    case "tata":
    item[`${i+16}`] = {note: note_category[i].value, duration: "4n"};
    break;
    case "un":
    item[`${i}`] = null;
    break;
    case "tau":
    item[`${i}`] = {note: note_category[i].value, duration: "4n"};
    item[`${i+16}`] = {note: null, duration: "4n"};
    break;
    case "uta":
    item[`${i}`] = {note: null, duration: "4n"};
    item[`${i+16}`] = {note: note_category[i].value, duration: "4n"};
    break;
    case "ta__n":
    item[`${i}`]["duration"] = "2n";
    break;
    case "ta_nta":
    item[`${i}`]["duration"] = "3n";
    break;
    case "tata_n":
    item[`${i}`]["duration"] = "8n";
    item[`${i+16}`] = {note: note_category[i].value, duration: "3n"};
    break;
    default:
  }
}

for(i = 1; i < rhythm_category.length; i+=2){
  if(rhythm_category[i-1].value == "ta__n"){
      item[`${i}`] = null;
    }
    else if(rhythm_category[i-1].value == "ta_nta"){
      item[`${i}`]= null;
      item[`${i+16}`] = {note: note_category[i].value, duration: "8n"};
    }
    else if(rhythm_category[i-1].value == "tata_n"){
      item[`${i}`] = null;
    }
  else{
    switch(rhythm_category[i].value){
    case "tata":
    item[`${i+16}`] = {note: note_category[i].value, duration: "4n"};
    break;
    case "un":
    item[`${i}`] = null;
    break;
    case "tau":
    item[`${i}`] = {note: note_category[i].value, duration: "4n"};
    item[`${i+16}`] = {note: null, duration: "4n"};
    break;
    case "uta":
    item[`${i}`] = {note: null, duration: "4n"};
    item[`${i+16}`] = {note: note_category[i].value, duration: "4n"};
    break;
    default:
    }
  }
}

const melodyList = [
  item["0"],item["16"],item["1"],item["17"],item["2"],item["18"],item["3"],item["19"],
  item["4"],item["20"],item["5"],item["21"],item["6"],item["22"],item["7"],item["23"],
  item["8"],item["24"],item["9"],item["25"],item["10"],item["26"],item["11"],item["27"],
  item["12"],item["28"],item["13"],item["29"],item["14"],item["30"],item["15"],item["31"]
];

function setPlay(time, note) {synth.triggerAttackRelease(note.note, note.duration, time);}
    const melody = new Tone.Sequence(setPlay, melodyList).start();
    melody.loop = 0;  
    Tone.Transport.start();
}

function playMelodyLatterHalf() {
  const synth = new Tone.Synth().toDestination();
  changeTempo();
  preparePlay();
  const item = {
  16:{note: note_category[16].value, duration: "4n"},
  17:{note: note_category[17].value, duration: "4n"},
  18:{note: note_category[18].value, duration: "4n"},
  19:{note: note_category[19].value, duration: "4n"},
  20:{note: note_category[20].value, duration: "4n"},
  21:{note: note_category[21].value, duration: "4n"},
  22:{note: note_category[22].value, duration: "4n"},
  23:{note: note_category[23].value, duration: "4n"},
  24:{note: note_category[24].value, duration: "4n"},
  25:{note: note_category[25].value, duration: "4n"},
  26:{note: note_category[26].value, duration: "4n"},
  27:{note: note_category[27].value, duration: "4n"},
  28:{note: note_category[28].value, duration: "4n"},
  29:{note: note_category[29].value, duration: "4n"},
  30:{note: note_category[30].value, duration: "4n"},
  31:{note: note_category[31].value, duration: "4n"},
  32:null,
  33:null,
  34:null,
  35:null,
  36:null,
  37:null,
  38:null,
  39:null,
  40:null,
  41:null,
  42:null,
  43:null,
  44:null,
  45:null,
  46:null,
  47:null
};

for(i = 16; i < rhythm_category.length; i+=2){
    switch(rhythm_category[i].value){
    case "tata":
    item[`${i+16}`] = {note: note_category[i].value, duration: "4n"};
    break;
    case "un":
    item[`${i}`] = null;
    break;
    case "tau":
    item[`${i}`] = {note: note_category[i].value, duration: "4n"};
    item[`${i+16}`] = {note: null, duration: "4n"};
    break;
    case "uta":
    item[`${i}`] = {note: null, duration: "4n"};
    item[`${i+16}`] = {note: note_category[i].value, duration: "4n"};
    break;
    case "ta__n":
    item[`${i}`]["duration"] = "2n";
    break;
    case "ta_nta":
    item[`${i}`]["duration"] = "3n";
    break;
    case "tata_n":
    item[`${i}`]["duration"] = "8n";
    item[`${i+16}`] = {note: note_category[i].value, duration: "3n"};
    break;
    default:
  }
}

for(i = 17; i < rhythm_category.length; i+=2){
  if(rhythm_category[i-1].value == "ta__n"){
      item[`${i}`] = null;
    }
    else if(rhythm_category[i-1].value == "ta_nta"){
      item[`${i}`]= null;
      item[`${i+16}`] = {note: note_category[i].value, duration: "8n"};
    }
    else if(rhythm_category[i-1].value == "tata_n"){
      item[`${i}`] = null;
    }
  else{
    switch(rhythm_category[i].value){
    case "tata":
    item[`${i+16}`] = {note: note_category[i].value, duration: "4n"};
    break;
    case "un":
    item[`${i}`] = null;
    break;
    case "tau":
    item[`${i}`] = {note: note_category[i].value, duration: "4n"};
    item[`${i+16}`] = {note: null, duration: "4n"};
    break;
    case "uta":
    item[`${i}`] = {note: null, duration: "4n"};
    item[`${i+16}`] = {note: note_category[i].value, duration: "4n"};
    break;
    default:
    }
  }
}

const melodyList = [
  item["16"],item["32"],item["17"],item["33"],item["18"],item["34"],item["19"],item["35"],
  item["20"],item["36"],item["21"],item["37"],item["22"],item["38"],item["23"],item["39"],
  item["24"],item["40"],item["25"],item["41"],item["26"],item["42"],item["27"],item["43"],
  item["28"],item["44"],item["29"],item["45"],item["30"],item["46"],item["31"],item["47"]
];

function setPlay(time, note) {synth.triggerAttackRelease(note.note, note.duration, time);}
    const melody = new Tone.Sequence(setPlay, melodyList).start();
    melody.loop = 0;  
    Tone.Transport.start();
}

 





</script>
　<script src="https://unpkg.com/tone@14.7.77/build/Tone.js"></script>
</body>
</html>
